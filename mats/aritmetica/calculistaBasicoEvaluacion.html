<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <script id="MathJax-script" async
        src="http://192.168.1.100:3000/public/resources/libraries/MathJax/mathjax.js"></script>
    <script src="http://192.168.1.100:3000/public/resources/libraries/vue.js"></script>


    <script src="http://192.168.1.100:3000/public/atlasConocimiento/components/bloque.js"></script>
    <script src="http://192.168.1.100:3000/public/atlasConocimiento/components/enlace.js"></script>
    <script src="http://192.168.1.100:3000/public/atlasConocimiento/components/recuadro.js"></script>

    <link rel="stylesheet" href="http://192.168.1.100:3000/public/atlasConocimiento/estilos/estilosGenerales.css">
    <link rel="stylesheet" href="http://192.168.1.100:3000/public/atlasConocimiento/components/recuadroEstilo.css">
    <link rel="stylesheet" href="http://192.168.1.100:3000/public/atlasConocimiento/components/bloqueEstilo.css">
    <link rel="stylesheet" href="http://192.168.1.100:3000/public/atlasConocimiento/components/enlaceEstilo.css">

    <title>Calculista básico - evaluación</title>
</head>

<body>

    <div id="doc">
        <p>Tengo la habilidad de un calculista básico si: </p>


        <!-- Suma -->
        <bloque-component tipo="evaluacion" textoCabecera="Puedo calcular cualquier suma entre números naturales.">

        </bloque-component>

        <!-- Resta -->
        <bloque-component tipo="evaluacion"
            textoCabecera="Puedo calcular cualquier resta positiva entre números naturales.">

        </bloque-component>

        <!-- Division -->
        <bloque-component tipo="evaluacion"
            textoCabecera="Puedo calcular cualquier división entera entre números naturales.">
            <div class="contenedorFlex">
                <div class="bloqueDificultad">
                    <span class="descripcion">
                        Dificultad
                    </span>

                    <input type="range" ref="inputDificultadDivision" id="inputDificultadDivision" v-model="dificultadDivision" min="1" max="3">
                </div>  

                <div class="boton" style="margin-top: 40px;" @click="generarDivision"
                    :class="{deshabilitado:estadoRespuestaDivision!='correcto' && expresionDivision }">
                    {{estadoRespuestaDivision=='correcto'?'¡Generar una nueva división':'¡Generar una división!'}}
                </div>

                <transition name="travelTop">
                    <div class="operacionReto" style="text-align: center; font-size: 35px;"
                        :key="versionExpresionDivision" v-show="expresionDivision">
                        {{expresionDivision}}
                    </div>
                </transition>

                <div class="bloqueConfirmarRespuesta" v-show="expresionDivision">
                    <span>Confirma aquí tu respuesta</span>
                    <input type="number" :class="{deshabilitado: estadoRespuestaDivision=='correcto'}"
                        v-model="inputResultadoDivision" style="max-width: 70px;">

                    <div class="boton" @click="confirmarDivision"
                        :class="{deshabilitado: !inputResultadoDivision}"
                        v-show="estadoRespuestaDivision!='correcto'">Aceptar</div>

                </div>

                <transition name="popIn">
                    <div class="bloqueInfoResultado" v-show="estadoRespuestaDivision"
                        :key="versionInputResultadoDivision">
                        <div class="mensajeInfoResultado"
                            :style="[{backgroundColor: estadoRespuestaDivision=='correcto'?'#269d26':'#ea4b4b'}]">
                            {{estadoRespuestaDivision=='correcto'?'¡Correcto!':'Incorrecto... ¡Sigue intentando!'}}
                        </div>
                    </div>
                </transition>
            </div>
        </bloque-component>

        <!-- Multiplicación -->
        <bloque-component tipo="evaluacion"
            textoCabecera="Puedo calcular cualquier multiplicación entre números naturales.">
            <div class="contenedorFlex">
                
                <div class="bloqueDificultad">
                    <span class="descripcion">
                        Dificultad
                    </span>

                    <input type="range" ref="inputDificultadMultiplicacion" id="inputDificultadMultiplicacion" v-model="dificultadMultiplicacion" min="1" max="3">
                </div>                

                <div class="boton" style="margin-top: 40px;" @click="generarMultiplicacion"
                    :class="{deshabilitado:estadoRespuestaMultiplicacion!='correcto' && expresionMultiplicacion }">
                    {{estadoRespuestaMultiplicacion=='correcto'?'¡Generar una nueva multiplicación':'¡Generar una multiplicación!'}}
                </div>

                <transition name="travelTop">
                    <div class="operacionReto" style="text-align: center; font-size: 35px;"
                        :key="versionExpresionMultiplicacion" v-show="expresionMultiplicacion">
                        {{expresionMultiplicacion}}
                    </div>
                </transition>

                <div class="bloqueConfirmarRespuesta" v-show="expresionMultiplicacion">
                    <span>Confirma aquí tu respuesta</span>
                    <input type="number" :class="{deshabilitado: estadoRespuestaMultiplicacion=='correcto'}"
                        v-model="inputResultadoMultiplicacion" style="max-width: 70px;">

                    <div class="boton" @click="confirmarMultiplicacion"
                        :class="{deshabilitado: !inputResultadoMultiplicacion}"
                        v-show="estadoRespuestaMultiplicacion!='correcto'">Aceptar</div>

                </div>

                <transition name="popIn">
                    <div class="bloqueInfoResultado" v-show="estadoRespuestaMultiplicacion"
                        :key="versionInputResultadoMultiplicacion">
                        <div class="mensajeInfoResultado"
                            :style="[{backgroundColor: estadoRespuestaMultiplicacion=='correcto'?'#269d26':'#ea4b4b'}]">
                            {{estadoRespuestaMultiplicacion=='correcto'?'¡Correcto!':'Incorrecto... ¡Sigue intentando!'}}
                        </div>
                    </div>
                </transition>
            </div>
        </bloque-component>


    </div>
</body>

</html>

<script>
    const doc = new Vue({
        el: "#doc",
        components: {
            recuadroComponent,
            bloqueComponent,
            enlaceComponent
        },
        data() {
            return {
                versionExpresionMultiplicacion: 0,
                expresionMultiplicacion: null,

                dificultadMultiplicacion:1,
                minMultiplicando: 1,
                maxMultiplicando: 10,
                minMultiplicador: 1,
                maxMultiplicador: 10,

                multiplicando: 1,
                multiplicador: 1,

                estadoRespuestaMultiplicacion: null,
                inputResultadoMultiplicacion: null,
                versionInputResultadoMultiplicacion: 0,


                versionExpresionDivision: 0,
                expresionDivision: null,

                dificultadDivision:1,
                minDivisor: 1,
                maxDivisor: 10,
                minResultadoDivision: 1,
                maxResultadoDivision: 10,

                numerador: 1,
                denominador: 1,

                estadoRespuestaDivision: null,
                inputResultadoDivision: null,
                versionInputResultadoDivision: 0,
            }
        },
        methods: {
            generarMultiplicacion() {
                if(Number(this.dificultadMultiplicacion)===1){
                    this.minMultiplicando=2;
                    this.maxMultiplicando=5;

                    this.minMultiplicador=2;
                    this.maxMultiplicador=4;
                }
                else if(Number(this.dificultadMultiplicacion)===2){
                    this.minMultiplicando=4;
                    this.maxMultiplicando=7;

                    this.minMultiplicador=3;
                    this.maxMultiplicador=5;
                }
                else if(Number(this.dificultadMultiplicacion)===3){
                    this.minMultiplicando=6;
                    this.maxMultiplicando=12;

                    this.minMultiplicador=4;
                    this.maxMultiplicador=8;
                }
                else{
                    console.log("Dificultad desconocida");
                    return;
                }

                if (this.minMultiplicando >= this.maxMultiplicando || this.minMultiplicador >= this.maxMultiplicador) {
                    console.log("Rango no válido");
                    return;
                }

                var minMultiplicando = parseInt(this.minMultiplicando);
                var maxMultiplicando = parseInt(this.maxMultiplicando);

                var minMultiplicador = parseInt(this.minMultiplicador);
                var maxMultiplicador = parseInt(this.maxMultiplicador);

                var numero1 = Math.round(Math.random() * (maxMultiplicando - minMultiplicando) + minMultiplicando);
                var numero2 = Math.round(Math.random() * (maxMultiplicador - minMultiplicador) + minMultiplicador);

                this.multiplicando = numero1;
                this.multiplicador = numero2;

                this.expresionMultiplicacion = `\\(${numero1} \\times ${numero2} \\)`;

                this.inputResultadoMultiplicacion = null;
                this.estadoRespuestaMultiplicacion = null;

                this.versionExpresionMultiplicacion++;

                this.$nextTick(() => {
                    MathJax.typeset();
                })
            },
            confirmarMultiplicacion() {
                var respuesta = this.multiplicando * this.multiplicador;
                console.log(`Comparando ${respuesta} con ${this.inputResultadoMultiplicacion}`)
                if (this.inputResultadoMultiplicacion == respuesta) {
                    this.estadoRespuestaMultiplicacion = "correcto";
                }
                else {
                    this.estadoRespuestaMultiplicacion = "incorrecto";
                }
                this.versionInputResultadoMultiplicacion++;
            },
            generarDivision() {
                
                if(Number(this.dificultadDivision)===1){
                    this.minResultadoDivision=2;
                    this.maxResultadoDivision=6;

                    this.minDivisor=2;
                    this.maxDivisor=5;
                }
                else if(Number(this.dificultadDivision)===2){
                    this.minResultadoDivision=4;
                    this.maxResultadoDivision=6;

                    this.minDivisor=3;
                    this.maxDivisor=6;
                }
                else if(Number(this.dificultadDivision)===3){
                    this.minResultadoDivision=6;
                    this.maxResultadoDivision=12;

                    this.minDivisor=4;
                    this.maxDivisor=8;
                }
                else{
                    console.log("Dificultad desconocida");
                    return;
                }


                const resDivision=Math.round(Math.random() * (this.maxResultadoDivision - this.minResultadoDivision) + this.minResultadoDivision);
                const divisor=Math.round(Math.random() * (this.maxDivisor - this.minDivisor) + this.minDivisor);


                this.numerador = resDivision*divisor;
                this.denominador = divisor;

                this.expresionDivision = `\\(${this.numerador} \\over ${this.denominador} \\)`;

                this.inputResultadoDivision = null;
                this.estadoRespuestaDivision = null;

                this.versionExpresionDivision++;

                this.$nextTick(() => {
                    MathJax.typeset();
                })
            },
            confirmarDivision() {
                var respuesta = this.numerador / this.denominador;
                console.log(`Comparando ${respuesta} con ${this.inputResultadoDivision}`)
                if (this.inputResultadoDivision == respuesta) {
                    this.estadoRespuestaDivision = "correcto";
                }
                else {
                    this.estadoRespuestaDivision = "incorrecto";
                }
                this.versionInputResultadoDivision++;
            }
        }
    })
</script>

<style>
    body {
        padding: 2% 5%;
    }

    input {
        padding: 5px 5px;
        font-size: 17px;
    }

    .contenedorFlex {
        display: flex;
        align-items: center;
        flex-direction: column;
    }

    .nota {
        margin: 5px auto;
        border-radius: 15px;
        background-color: rgb(233, 185, 150);
        padding: 15px;
        width: min(600px, 90%);
    }

    .resaltado {
        padding: 2px 3px;
        border-radius: 2px;
    }

    .bloqueRango {
        display: flex;
        margin: 10px 10px;
        display: flex;
        justify-content: center;
    }

    .limiteRango {
        max-width: 70px;
        margin: 0px 10px;
    }
</style>